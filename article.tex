%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper]{llncs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[all]{xy}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{complexity}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareMathOperator{\RUN}{run}
\DeclareMathOperator{\RED}{red}
\DeclareMathOperator{\AV}{Av}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% 231,213
\newcommand{\myPattern}{231,231}

% avoid set
\DeclareMathOperator{\Avd}{Av}
\newcommand\Av[2]{\Avd_{{#1}}({#2})}

% le set de toutes les permitaton
\newcommand{\Perm}[1]{\mathcal{S}_{#1}}

% permutation text
\newcommand{\ptext}{\pi}

% permutation motif
\newcommand{\pmotif}{\sigma}

\newcommand{\x}{X}
\newcommand{\y}{Y}
\newcommand{\bmotif}{(\sigma,\x,\y)}

%Stripe
\DeclareMathOperator{\stripea}{s}
\newcommand{\stripe}[2]{\stripea_{{#1}}({#2})}
\newcommand{\stripew}[1]{\stripea_{{#1}}}

% compteur pour les proposition, definition etc...
\newcounter{num}
\setcounter{num}{0}
\newcommand{\num}{\stepcounter{num} }
\newcommand{\numl}[1]{\refstepcounter{num}\label{#1}}

%downstep
\newcommand{\dstep}{d}

%upstep
\newcommand{\ustep}{a}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Pattern matching for\\ $(231,213)$-avoiding permutations}
\author{Both Emerite NEOU, Romeo RIZZI}
\date{}

\author{%
	Both Emerite Neou\inst{1,3}
  Romeo Rizzi\inst{2} \and
  St\'ephane Vialette\inst{3}
}% end author
\institute{%
  Department of Computer Science,
  Università degli Studi di Trento, Italy \\	
	\and
  Department of Computer Science,
  Università degli Studi di Verona, Italy \\
  \email{romeo.rizzi@univr.it}
  \and
	Universit\'e' Paris-Est, LIGM (UMR 8049), CNRS, UPEM, ESIEE Paris, ENPC, 
	F-77454, Marne-la-Vallée, France\\
  \email{vialette@univ-mY.fr}
}% end institute

\date{\today}

\maketitle

\begin{abstract}
bla bla\ldots
\end{abstract}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
\label{section:Introduction}

	A permutation $\pi$ is said to contain another permutation $\sigma$,
	in symbols $\sigma \preceq \pi$,
	if there exists a subsequence of entries of $\pi$ that has the same relative
	order as $\sigma$, and in this case $\sigma$ is said to be a 
	\emph{pattern} of $\pi$.
	Otherwise, $\pi$ is said to avoid the permutation $\sigma$.
	For example a permutation contains the pattern $123$ (resp. $321$) if it has
	an increasing (resp. decreasing) subsequence of length $3$.
	Here, note that members need not actually to be consecutive, 
	merely increasing (resp. descreasing).
	During the last decade, the study of the pattern containment on permutations has
	become a very active area of research.

	We consider here the so-called \emph{pattern containment} problem
	(also sometimes referred to as the \emph{pattern involvement problem}):
	Given two permutations $\sigma$ and $\pi$, this problem is to decide whether
	$\sigma \preceq \pi$ (the problem is ascribed to Wilf in \cite{Bose:Buss:Lubiw:1998}).
	The permutation containment problem is \NPhard~\cite{Bose:Buss:Lubiw:1998}.
	It is, however, polynomial-time solvable by brute-force enumeration
	if $\sigma$ has bounded size.
	Improvements to this algorithm were presented in
	\cite{Albert:Aldred:Atkinson:Holton:ISAAC:2001} and
	\cite{Ahal:Rabinovich:2008},
	the latter describing a $O(|\pi|^{0.47k+o(|\sigma| )})$ time algorithm.
	Bruner and Lackner \cite{Bruner:Lackner:SWAT:2012}
	gave a fixed-parameter algorithm solving the pattern containment problem with
	an exponential worst-case runtime of $O(1.79^{\RUN(\pi)})$,
	where $\RUN(\pi)$ denotes the number of alternating runs of $\pi$.
	(This is an improvement upon the $O(2^{|\pi|})$ runtime required by
	brute-force search without imposing restrictions on $\sigma$ and $\pi$.)
	Of particular importance, it was recently proved that
	the permutation containment problem is fiexed-parameter tractable for
	parameter $|\sigma|$
	\cite{Guillemot:Marx:SODA:2014}.

	A few particular cases of the pattern containment problem have been attacked successfully.
	The case of increasing patterns is solvable in
	$O(|\pi| \log \log |\sigma|)$ time in the RAM model \cite{Crochemore:Porat:2010},
	improving the previous 30-year bound of $O(|\pi| \log |\sigma|)$.
	(The algorithm also improves on the previous
	$O(|\pi| \log \log |\pi|)$ bound.)
	Furthermore, the patterns $132$, $213$, $231$, $312$ can all be handled in linear time
	by stack sorting algorithms.
	Any pattern of length $4$ can be detected in $O(|\pi| \log |\pi|)$ time
	\cite{Albert:Aldred:Atkinson:Holton:ISAAC:2001}.
	Algorithmic issues for $321$-avoiding patterns containment has been investigated in
	\cite{Guillemot:Vialette:ISAAC:2009}.
	The pattern containment problem is also solvable in
	polynomial-time for separable patterns \cite{Ibarra:1997}
	(see also \cite{Bose:Buss:Lubiw:1998}).
	Separable permutations are those permutations that contain neither
	$2413$ nor $3142$, and they are enumerated by the Schröder numbers
	(sequence A006318 in OEIS).
	To the best of our knowledge,
	separable permutations first arose in the work of
	Avis and Newborn~\cite{Avis:Newborn:1981},
	who showed that they are precisely the permutations which can be sorted by an
	arbitrary number of pop-stacks in series,
	where a pop-stack is a restricted form of stack in which any pop operation
	pops all items at once.
	(Notice that the separable permutations include as a special case the
	stack-sortable permutations, which avoid the pattern $231$.)

	There exist many generalisation of patterns that are worth considering
	in the context of algorithmic issues in pattern involvement
	(see \cite{Kitaev:book:2011} for an up-to-date survey).
	\emph{Vincular patterns}, also called 
	\emph{generalized patterns},
	resemble (classical) patterns, with the constraint that some of the letters in
	an occurrence must be consecutive.
	Of particular importance in our context,
	Bruner and Lackner \cite{Bruner:Lackner:SWAT:2012}
	proved that deciding whether a vincular pattern
	$\sigma$ of length $k$ occurs in a permutation
	$\pi \in \mathfrak{S}_n$ is $W[1]$-complete for
	parameter $k$.
	\emph{Bivincular patterns} generalize classical patterns even further 
	than vincular
	patterns. Indeed, in bivincular patterns,
	not only positions but also values
	of elements involved in a matching may be forced to be adjacent

	We focus in this paper on pattern matching issues for
	$(213,231)$-avoiding permutations.
	The number of $n$-permutations that avoid both 
	$231$ and $213$ is 
	$t_0 = 1$ for $n = 0$ and 
	$t_n =2^{n−1}$ for $n\geq 1$ \cite{Simion:Schmidt:EJC:1985}.
	The permutations that do not contain the permutation pattern $231$
	are exactly the \emph{stack-sortable permutations} and they are counted by 
	the Catalan numbers \cite{Knuth:1997:ACP:260999}.
	A stack-sortable permutation is a permutation whose elements may be sorted by 
	an algorithm whose internal storage is limited to a single stack data structure.

	This paper is organized as follows.
	
%	The permutation pattern problem asks if there exists a normalized subsequence of a text $\ptext$ which equals to a motif $\pmotif$.
%	If so we write $\pmotif \preceq \ptext$.
%	If not we say that $\ptext$ \textbf{avoid} $\pmotif$.
%	This was first introduced by Knuth \cite{Knuth:1997:ACP:260999}
%	who proves that permutation sortable by stacks
%	avoid the motif $231$. 
%	The problem is NP-hard in general,
%	but for some classes of permutation,
%	polynomial time solution exists.
%	For instance the separable permutation \cite{Bose93patternmatching}.
%	We contribute studying this problem 
%	and related one for the class of permutation avoiding (231,213). 
%	This is interesting because this class is in linear bijection between the classes of (123,132),(132,213) and (132,213)
%	avoiding permutation, and all the classes obtainable by reversal or/and
%	complementation (see \cite{Simion1985383}).\\
%	 
%
%	
%	This paper is organized as follows.
%	Section 2 presents the needed definition.
%	Section 3 solves the permutation pattern problem with
%	(213,231) avoiding permutations.
%	Section 4 focus on the problem the
%	related problem of computing a longest permutation avoiding (213,231).
%	Finally, section 5 summarizes 
%	results for related problems. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
\section{Definition}
\label{section:Definitions}

A \emph{permutation} of length $n$ is a one-to-one function from an
$n$-element set to itself.
We write permutations as words 
$\sigma = \sigma_1\sigma_2\,\ldots\,\sigma_n$, whose letters are distinct
and uasually consist of the integers $12\,\ldots\,n$.
For the sake of convenience, 
we let 
$\pi[i:j]$ stand for 
$\pi_i\pi_{i+1}\,\ldots\,\pi_j$,
$\pi[:j]$ stand for $\pi[1:j]$ and
$\pi[i:]$ stand for $\pi[i:n]$.
We let $S_n$ denote the set of all permutations of length $n$.

% The \emph{reduced form} of a permutation $\sigma$ on a set
% $\{j_1, j_2, \ldots, j_k\}$ where
% $j_1 < j_2 < \ldots < j_n$ is the permutation $\sigma'$
% obtained by renaming the letters of $\sigma$ so that 
% $j_i$ is renamed $i$ for all $1 \leq i \leq k$.
% We let $\RED(\sigma)$ denote the reduced form of $\sigma$.
% For example $\RED(453) = 231$
% while $\RED(3174) = 2143$.

A permutation $\pi$ is said to \emph{contain} the permutation $\sigma$ 
if there exists a subsequence of (not necessarily consecutive) 
entries of $\pi$ that has the same relative order as $\sigma$, 
and in this case $\sigma$ is said to be a \emph{pattern} of 
$\pi$, written $\sigma \preceq \pi$. 
Otherwise, $\pi$ is said to \emph{avoid} the permutation $\sigma$. 
For example, the permutation $\pi = 391867452$ 
contains the pattern $\sigma = 51342$, 
as can be seen in the highlighted subsequence of 
$\pi = 3\mathbf{9}\mathbf{1}8\mathbf{6}\mathbf{7}\mathbf{4}52$
(or 
$\pi = 3\mathbf{9}\mathbf{1}8\mathbf{6}\mathbf{7}4\mathbf{5}2$
or
$\pi = 3\mathbf{9}\mathbf{1}8\mathbf{6}\mathbf{7}45\mathbf{2}$
). 
Each subsequence $(91674$, 
$91675$, 
$91672$) is called a 
\emph{copy}, 
\emph{instance}, or 
\emph{occurrence} of $\sigma$. 
Since the permutation $\pi = 391867452$  contains no increasing subsequence of length four, $\pi$ avoids $1234$.

Suppose $P$ is a set of permutations. We let $\AV_n(p)$ denote the
set of all $n$-permutations avoiding each permutation in $P$.
For the sake of convenience, we omit $P$'s braces thus having
e.g. $\AV_3(132,4312)$ instead of
$\AV_3(\{132,4312\})$.
A basic example is if 
$\pi = \pi_1\pi_2\,\ldots\,\pi_n$ avoids $321$, i.e., 
has no decreasing subsequence of length $3$, then its reverse, 
$\pi' = \pi_n\pi_{n-1}\,\ldots\,\pi_1$ avoids $123$, i.e., 
has no increasing subsequence of length $3$.

An \emph{ascent} of a permutation $\pi \in S_n$ is any position 
$1 \leq i < n$ where the following value is bigger than the current one. 
That is, if $\pi = \pi_1\pi_2\,\ldots\,\pi_n$, then
$i$ is an ascent if $\pi_i < \pi_{i+1}$.
For example, the permutation 
$345216$7 has ascents (at positions) $1,2,5,6$.
Similarly, a \emph{descent} is a position 
$1 \leq i < n$ with $\pi_i > \pi_{i+1}$, 
so every $i$ with $1 \leq i < n$ either is an ascent or is a descent of 
$\pi$.
Let $\ustep$ and $\dstep$ denote an ascend and a descend, respectively.
The \emph{stripe} $s_\pi$ of a permutation $\pi \in S_n$ is the word
$\stripe{\pi}{1} \stripe{\pi}{2} \ldots \stripe{\pi}{n-1} \in \{\ustep,\dstep\}^{n-1}$ 
defined by 
$ \stripe{\pi}{i}= \ustep$ if $i$ an ascent in $\pi$ and
$\stripe{\pi}{i} = \dstep$ if $i$ a descent in $\pi$.
For example the stripe of the permutation 
$\pi = 12\,11\,10\,1\,2\,3,4\,9\,8\,5\,6\,7$ 
is 
$\stripew{\pi} = \dstep\dstep\dstep\ustep\ustep\ustep\ustep\dstep\dstep\ustep\ustep$.
The stripe $s\stripew{\sigma}$ is a \emph{pattern} of the strip $\stripew{\pi}$
(or $s\stripew{\sigma}$ \emph{occurs} of the strip $\stripew{\pi}$) if $\stripew{\sigma}$ occurs in
$\stripew{\pi}$ as a subsequence.

% For two permutations $\
% The stripe $s\pi$ of $\pi \in S-n$ is a motif pmotif \in \Perm{m}$ is a motif
% of a stripe of $\ptext \in \Perm{n}$ if and only if there exist an increasing function $\phi : [|\pmotif|] \rightarrow [|\pmotif|]$
% such that : \\
% $\forall i \in [|\pmotif|]$, $\mathcal{S}(\pmotif,i) = \mathcal{S}(\ptext,\phi(i))$\\
% If a stripe $S_2$ is a motif of a stripe $S_1$,
% it means that there exists
% a subsequence of $S_1$ such as
% this sequence is equal to $S_2$.

% For example, the stripe $(\dstep_1,\dstep_2,\dstep_3,\dstep_4,\ustep_1)$ is a motif of  the stripe \\
% $(\dstep_1,\dstep_2,\dstep_3,\ustep_1,\ustep_2,\ustep_3,\ustep_4,\dstep_4,\dstep_5,\ustep_5,\ustep_6)$ ,
% because we can match \\
% $(\dstep_1,\dstep_2,\dstep_3,\dstep_4,\ustep_1)$ to $(\dstep_1,\dstep_2,\dstep_3,\dstep_4,\ustep_5,\ustep_6)$.
% \begin{figure}[h!]
% 	\begin{displaymath}
% 		\xymatrix@=0.3cm{
% 			\dstep_1 \ar[dd] & \dstep_2 \ar[dd] & \dstep_3 \ar[dd] & \dstep_4\ar[ddrrrr]  & \ustep_1 \ar[ddrrrrr]\\
% 			\\
% 			\dstep_1 & \dstep_2 & \dstep_3 & \ustep_1 & \ustep_2 & \ustep_3 & \ustep_4 & \dstep_4 & \dstep_5 & \ustep_5 & \ustep_6 \\
% 		}
% 	\end{displaymath}     
% \end{figure}		
% But the stripe $(\dstep,\ustep,\dstep,\dstep,\dstep)$ is not a motif of the stripe\\ $(\dstep_1,\dstep_2,\dstep_3,\ustep_1,\ustep_2,\ustep_3,\ustep_4,\dstep_4,\dstep_5,\ustep_5,\ustep_6,\ustep_7)$.\\
		
% A \textbf{bivincular motif} generalize
% a motif. 
% A bivincular motif allows 
% to force element to be adjacent in position
% or/and in value.
% A bivincular motif
% is a motif with two set $\bmotif$,
% the first set contains the first index 
% of two consecutive indexes
% and the second set contains the first indexes
% of the two consecutive elements.
% Formally, Let $\bmotif$ 
% be a bivincular motif 
% and $\ptext$ a permutation.
% if $i \in \x$,
% and $i$ is matched with $j$ in $\ptext$
% then $i+1$ must be matched with $j+1$,
% with the special case of $0$ and $|\pmotif|$ :
% if $0 \in \x$ then the first element of $\pmotif$
% must be matched with the first element of $\ptext$,
% and if $|\pmotif| \in \x$ then the last element of $\pmotif$
% must be matched with the last element of $\ptext$.
% if $i \in \y$,
% and $i$ is matched with $j$ in $\ptext$
% then $i+1$ must be matched with $l$
% such as $\ptext(l)=\ptext(j)+1$,
% with the special case of $0$ and $|\pmotif|$ :
% if $0 \in \y$ then the minimal element of $\pmotif$
% must be matched with the minimal element of $\ptext$,
% and if $|\pmotif| \in \y$ then the maximal element of $\pmotif$
% must be matched with the maximal element of $\ptext$.		
			
A \emph{bivincular pattern} (abbreviated BVP) $\sigma$
of length $k$ is a permutation in $S_k$ written in
two-line notation 
(that is the top row is $12\,\ldots\,k$ and the bottom row
is a permutation $\sigma_1\sigma_2\,\ldots\,\sigma_k$).
We have the following conditions on the top and bottom rows
of $\sigma$:
\begin{itemize}
	\item
	If the bottom line of $\sigma$ contains
	$\underline{\sigma_i\sigma_{i+1}\,\ldots\,\sigma_j}$
	then the letters corresponding to 
	$\sigma_i\sigma_{i+1}\,\ldots\,\sigma_j$ in an occurrence of
	$\sigma$ in a permutaton must be adjacent, whereas there is
	no adjacency condition for
	non-underlined consecutive letters.
	Moreover if the bottom row of $\sigma$ begins with
	$_\llcorner{\sigma_1}$ then any occurrence of $\sigma$ 
	in a permutation $\pi$ must begin with the leftmost 
	letter of $\pi$,
	and 
	if the bottom row of $\sigma$ begins with
	${\sigma_k}_\lrcorner$ then any occurrence of $\sigma$ 
	in a permutation $\pi$ must end with the rightmost 
	letter of $\pi$.
	\item
	If the top line of $\sigma$ contains
	$\overline{i\,i+1\,\ldots\,j}$ then the letters corresponding to
	$\sigma_i, \sigma_{i+1}, \ldots, \sigma_j$ in an
	occurrence of $\sigma$ in a permutation must be adjacent in values,
	whereas there is no value adjacency restriction for non-overlined 
	letters.
	Moreover, if the top row of $\sigma$ begins with
	$^ulcorner{1}$ then
	any occurrence of $\sigma$ is a permutation $\pi$ must begin with
	the smallest letter of $\pi$, and
	if top row of $\sigma$ ends with $k^\urcorner$ then
	any occurrence of $\sigma$ is a permutation $\pi$ must end with
	the largest letter of $\pi$.
\end{itemize}
A bivincular pattern avoids a set of permutations $P$ if its bottom
row $\sigma_1\sigma_2\,\ldots\,\sigma$ avoids every permutation in $P$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Both $\pi$ and $\sigma$ are $(231,213)$-avoiding}
\label{section:both are (231,213)-avoiding}

This section is devoted to presenting a fast algorithm for deciding
$\sigma \leq \pi$ 
in case both $\pi$ and $\sigma$ are $(231,213)$-avoiding.

\begin{lemma}[Folklore]
\label{lemma:first element is 1 or n}
The 􏰅first element of any $(213,231)$-avoiding permutation
must be either $1$ or $n$.
\end{lemma}

\begin{proof} 
Any other initial element would serve as a `$2$' in either a 
$231$ or $213$ with $1$ and $n$ as the `$1$' and `$3$' respectively.
\qed
\end{proof}
	
The above lemma gains in interest in the form of the following corollaries.

\begin{corollary}
\label{corollary:minmaxelement}
$\pi \in \AV_n(213,231)$ if and only if for $1 \leq i \leq n$, 
$\pi[i:]$ start either with the maximal element
or the minimal element of $\pi[i:]$.
\end{corollary}
	
\begin{corollary}
Let $\pi \in \AV_n(213,231)$. We have
$$
\stripe{\pi}{i} =
\begin{cases}
			\ustep & \text{if $\pi(i)$ is the minimal element of $\pi[i:]$}\\    
			\dstep & \text{if $\pi(i)$ is the maximal element of $\pi[i:]$}\\
	\end{cases}
	$$
\end{corollary}
	 
\begin{lemma}
\label{lemma:MatchStripeToPermutation}
Given two permutations $\ptext$,$\pmotif$ avoiding (231,213), If $\stripew{\pmotif}$ is a motif of stripe $\stripew{\ptext}$ by a subsequence $s$, then $\pmotif$ is a motif of $\ptext$ by subsequence $s$.
\end{lemma}	 
	 
\begin{proof} 
We prove the lemma by induction on the size of the motif. Suppose that we have the motif $(12)$, thus the stripe is $\ustep$. If there is a match in stripe, then there exists two (contiguous) increasing elements in the text, which is a match in permutation. Same goes for the permutation $(21)$. Now, suppose that the lemma is true for every motif of size $n$. Let $\pmotif$ be a motif of size $n+1$ avoiding $(213,231)$, and $\ptext$ a permutation avoiding $(213,231)$. If there is a match of $\stripew{\pmotif}$ in $\stripew{\ptext}$ by subsequence $s$, then there is a match of $\stripew{\pmotif}[2:]$ in $\stripew{\ptext}[2:]$ by subsequence $s[2:]$, and by induction there is a match of $\pmotif[2:]$ in $\ptext[2:]$ by subsequence $s[2:]$. Moreover suppose that the first element the stripe of the motif is ascend (descent), and by lemma \ref{lemma:first element is 1 or n} the minimal (maximal) element, and remark that a subsequence of a permutation avoiding (231,213) is also avoiding (231,213), thus the first element of the subsequence $s$ is either the minimal (maximal) element which complete our proof.
\end{proof}	 

\begin{proposition}
\label{proposition:patternMatchingStripe}
Let $\ptext$ and $\pmotif$ be two permutations avoiding (213,231).
$\pmotif$ is a motif of $\ptext$ if and only if the 
stripe of $\pmotif$ is a motif of the stripe of $\ptext$.
\end{proposition}

		
\begin{proof}
$\Rightarrow$ Suppose that $\pmotif$ is a motif of $\ptext$ by subsequence $s$. By definition $s$ normalized is equal to
$\pmotif$ so they have the same stripe.\\ 
$\Leftarrow$ This is proved by lemma \ref{lemma:MatchStripeToPermutation}.
\end{proof}
	 
%We need the following lemmata
%(the proofs of Lemma~\ref{lemma:upup} and Lemma~\ref{lemma:downdown} 
%are analogous and we omit them).
%
%\begin{lemma}
%	\label{lemma:updown}
%	Let $\pi \in \AV_n(213,231)$.
%	For all $1 \leq i < j \leq n$, 
%	if $\stripe{\pi}{i}=\ustep$
%	and $\stripe{\pi}{j}=\dstep$
%	then $\pi[i] < \pi[j]$.
%\end{lemma}
%		
%\begin{proof} 
%By induction on the size of the permutation.
%The proposition is certainly true for the $12$ and $21$.
%Suppose the proposition holds true for $\AV_n(213,231)$.
%Let $\pi \in \AV_{n+1}(213,231)$ and
%$\pi'$ be the permutation $\pi[2:]$.
%$\pi' \in \AV_n(213,231)$.
%By induction hypothesis, we only need to compare the first
%element of $\pi'$ to every element in $\pi'$.
%According to lemma~\ref{lemma:first element is 1 or n},
%the first element of $\pi$ is either $1$ or $n$.
%If the first element of $\pi$ is $1$ then $s_\pi(1) = a$
%and $\pi(i) < \pi(j)$ for every $2 \leq j \leq n$.
%If the first element of $\pi$ is $n$ then
% $s_\pi(1) = d$.
%\qed
%\end{proof}
%
%\begin{lemma}
%	\label{lemma:upup}
%	Let $\pi \in \AV_n(213,231)$.
%	For all $1 \leq i < j \leq n$,
%	if $\stripe{\pi}{i}=\ustep$
%	and $\stripe{\pi}{j}=\ustep$
%	then $\pi[i] < \pi[j]$.
%\end{lemma}
%		
%
%\begin{lemma}
%	\label{lemma:downdown}
%	Let $\pi \in \AV_n(213,231)$.
%	For all $1 \leq i < j \leq n$,
%	if $\stripe{\pi}{i} = \dstep$
%	and $\stripe{\pi}{j} = \dstep$
%	then $\pi[i] > \pi[j]$.
%\end{lemma}
%
%
%Most of the interest of the above lemmata stems from the following proposition.
%
%\begin{proposition}
%	\label{proposition:patternMatchingStripe}
%	Let $\ptext$ and $\pmotif$ be two permutations avoiding (213,231).
%	$\pmotif$ is a motif of $\ptext$ if and only if the 
%	stripe of $\pmotif$ is a motif of the stripe of $\ptext$.
%\end{proposition}
%
%		
%		\textbf{Proof} \\
%		$\Rightarrow$ Suppose that $\pmotif$ is a motif of $\ptext$
%		by subsequence $s$.
%		By definition $s$ normalized is equal to
%		$\pmotif$ so they have the same stripe.\\ 
%		$\Leftarrow$ 
%		Let $\ptext$ be a permutation avoiding $(213,231)$, 
%		$S_1$ be its stripe, 
%		$\pmotif$  be a permutation avoiding $(213,231)$, 
%		and $S_2$ its stripe.
%		Let $\phi$ be the function
%		that match $S_2$ to $S_1$.
%		We define $\varphi$ as, 
%		$\forall x \in [|\pmotif|-1]$,
%		$\varphi(x) = \phi(x)$,
%		and $\varphi(|\pmotif|) = \phi(|\pmotif|-1)+1$
%		Suppose that $\exists x,y \in [|\pmotif|]$, 
%		$\pmotif(x)<\pmotif(y)$ 
%		and $\ptext(\varphi(x))>\ptext(\varphi(y))$,
%		without lost of generality we can suppose that $x<y$,
%		Let see all the case possible that can make this 
%		hypothesis possible :
%		\begin{itemize}		
%			\item if $\pmotif(x)<\pmotif(y)$, 
%			$\stripe{\pmotif}{x}=\ustep$ 
%			and $\stripe{\pmotif}{y}=\ustep$
%			(if x and y are increasing in $\pmotif$),
%			then $\stripe{\ptext}{\varphi(x)} =\ustep$ and $\stripe{\ptext}{\varphi(y)}=\ustep$,
%			(the match are also increasing).
%			As $x<y$ and as $\varphi$ is an increasing function, 
%			$\varphi(x) < \varphi(y)$.
%			And thus, by \textbf{Lemma \ref{lemma:upup}},
%			$\ptext(\varphi(x)) < \ptext(\varphi(y))$ .
%			Which contradict our hypothesis,
%			so this case is not possible.
%		
%			\item if $\pmotif(x)<\pmotif(y)$, 
%			$\stripe{\pmotif}{x}=\ustep$ 
%			and $\stripe{\pmotif}{y}=\dstep$
%			then $\stripe{\ptext}{\varphi(x)}=\ustep$ and $\stripe{\ptext}{\varphi(y)}=\dstep$,
%			As $x<y$ and as $\varphi$ is an increasing function, 
%			$\varphi(x) < \varphi(y)$.
%			And thus, by \textbf{Lemma \ref{lemma:updown}},
%			$\ptext(\varphi(x)) < \ptext(\varphi(y))$ .
%			Which contradict our hypothesis,
%			so this case is not possible.			
%
%			\item if $\pmotif(x)>\pmotif(y)$, 
%			$\stripe{\pmotif}{x}=\dstep$ 
%			and $\stripe{\pmotif}{y}=\dstep$
%			then $\stripe{\ptext}{\varphi(x)}=\dstep$ and $\stripe{\ptext}{\varphi(y)}=\dstep$,
%			As $x<y$ and as $\varphi$ is an increasing function, 
%			$\varphi(y) < \varphi(x)$.
%			And thus, by \textbf{Lemma \ref{lemma:downdown}},
%			$\ptext(\varphi(y)) > \ptext(\varphi(x))$ .
%			Which contradict our hypothesis,
%			so this case is not possible.
%			
%			\item if $\pmotif(x)>\pmotif(y)$, 
%			$\stripe{\pmotif}{x}=\dstep$ 
%			and $\stripe{\pmotif}{y}=\ustep$
%			then $\stripe{\ptext}{\varphi(x)}=\dstep$ and $\stripe{\ptext}{\varphi(y)}=\ustep$,
%			As $x<y$ and as $\varphi$ is an increasing function, 
%			$\varphi(y) < \varphi(x)$.
%			And thus, by \textbf{Lemma \ref{lemma:updown}},
%			$\ptext(\varphi(y)) > \ptext(\varphi(x))$ .
%			Which contradict our hypothesis,
%			so this case is not possible.$\Box$
%			
%			\item If $y = |\pmotif|$ and $x=|\pmotif|-1$,
%			Clearly if $\stripe{\pmotif}{x}=\ustep$,
%			then $\pmotif(y)-\pmotif(x)>0$ 
%			and because we have a match in the ribbon
%			$\ptext(\varphi(y))-\ptext(\varphi(x))>0$.
%			Same idea goes if $\stripe{\pmotif}{x}=\dstep$.
%			So this case is not possible.
%			
%			\item if $y = |\pmotif|$ and $x<|\pmotif|-1$,
%			if $\stripe{\pmotif}{x}=\ustep$ ie
%			$\pmotif(x+1)-\pmotif(x)>0$. Then
%			we must have either
%			$\pmotif(x)<\pmotif(x+1)<\pmotif(|\pmotif|)$
%			or $\pmotif(x)<\pmotif(|\pmotif|)<\pmotif(x+1)$ 
%			to avoid $231$ or $213$ in the motif.
%			Because we have a match in the stripe
%			and what we prove above,
%			$\ptext(\varphi(x+1)-\ptext(\varphi(x))>0$.
%			But by hypothesis $\ptext(\varphi(|\ptext|))<\ptext(\varphi(x))$,
%			so we have either 		
%			$\pmotif(|\pmotif|)<\pmotif(x)<\pmotif(x+1)$
%			or $\pmotif(|\pmotif|)<\pmotif(x)<\pmotif(x+1)$ 
%			which both lead to a $231$ or a $213$ motif
%			in the text which is not possible.
%			The same idea goes if $\stripe{\pmotif}{x}=\dstep$. 			
%			
%		\end{itemize}
%		So our hypothesis is not realisable.So our assertion is true. $\Box$\\
		
		\textbf{Proposition  \num \thenum} Let $\pmotif$ and $\ptext$
		be two permutations avoiding (231,213), 
		we can decide in linear time if $\pmotif$ 
		appear in $\ptext$.\\	
		
		\begin{proof}
		To solve the permutation pattern for a permutation in $\AV_n(213,231)$, 
		we find a find a match of the stripe of the pattern in the stripe of the text.
		This can be done linearly by a greedy algorithm, 
		by matching a step whenever it is possible.
		And thank to the definition of the definition of a stripe in \textbf{Corollary \ref{corollary:minmaxelement}},
		we do not have to compute the stripe advance.
		Therefore we have an linear (online) algorithm.
		\end{proof}	

		

			
%		\subsection{With Motif Avoiding (231,213)}	
%		
%			\textbf{Proposition \num} Let $\pmotif$, $\ptext$ 
%			be two permutation,
%			with  $\pmotif$ a permutation avoiding (231,213), 
%			we can decide in $O(|\pmotif|*|\ptext|^3)$ time
%			and $O(|\ptext|^3) space$
%			if $\pmotif$ 
%			appear in $\ptext$.\\	
%
%			\textbf{Proof}
%			We consider the following problem :\\
%			
%			Given a motif $\pmotif$ avoiding $(231,213)$,
%			a text $\ptext$, $i$,$j$ , $i<j$.\\
%			
%			$\mathbb{P}_{\pmotif,\ptext,min,max}(i,j)= \left\{ 
%				\begin{array}{l l}
%					true & \text{If the sufixe of $\pmotif$ starting at $i$}\\
%						& \text{is a pattern of the suffix of $\ptext$} \\
%						& \text{with every element in $[min,max]$}\\
%		
%					false & otherwise\\
%				\end{array} \right.$\\
%		
%			$\mathbb{P}_{\pmotif,\ptext,min,max}$ is closed under induction. 
%			it can be
%			solved by means of the following relations:\\
%			
%			
%			\textbf{BASE :} \\
%			$\mathbb{P}_{\pmotif,\ptext,min,max}(|\pmotif|,j)= \left\{ 
%					\begin{array}{l l}
%						true & \text{if $min < \ptext(j) < max$
%						}\\
%						false & otherwise\\
%					\end{array} \right. $\\	
%		
%			\textbf{STEP :} \\
%			$\mathbb{P}_{\pmotif,\ptext,min,max}(i,j)= \left\{ 
%					\begin{array}{l l}
%						False & \text{if $\ptext(j)<min$ or $max<\ptext(j)$}\\
%						\bigcup_{j<k}\mathbb{P}_{\pmotif,\ptext,t(j),max}(i+1,k) 
%							& \text{if $\\mathcal{S}(\pmotif,i)=\ustep$
%							}\\
%						\bigcup_{j<k}\mathbb{P}_{\pmotif,\ptext,min,t(j)}(i+1,k) 
%							& \text{if $\\mathcal{S}(\pmotif,i)=\dstep$
%							}\\
%					\end{array} \right. $\\
%			At each step, 
%			we are match the current element of $\pmotif$ ($\pmotif(i)$)
%			with the current element of $\ptext$ ($\ptext(j)$), if possible.
%			then we are match the rest of $\pmotif$ with 
%			every suffixes $\ptext$ starting after $j$.
%			Clearly there is a match if and only if 	$\bigcup_{0<k<|\ptext|,0<min<max<|\ptext|}\mathbb{P}_{\pmotif,\ptext,min,t(j)}(0,k)$
%			is true.   
%			This implies a $O(|\pmotif|*|\ptext|^3)$ time
%			and $O(|\ptext|^3) space$ algorithm.\\ 

		
		\section{Pattern Matching With Motif Avoiding (231,213)}	

			\begin{proposition}
			Let $\pmotif$, $\ptext$ 
			be two permutation,
			with  $\pmotif$ a permutation avoiding (231,213), 
			we can decide in $O(|\pmotif|*|\ptext|^2)$ time
			and $O(|\pmotif|*|\ptext|^2)$ space
			if $\pmotif$ 
			is a motif of $\ptext$.
			\end{proposition}

			
%			\textbf{Proof}
%			The main point is that
%			if we match a ascnt (descent) element $i_{\pmotif}$ of the motif
%			with an element $i_{\ptext}$ of the text,
%			the optimal way of matching
%			the first previous ascnt (descent)
%			that appear before an descent (ascent)
%			is to choose the
%			maximal (minimal) element possible.
%			Indeed if we do not take
%			the maximal (minimal) element,
%			we may prevent some element
%			in the future matching.\\
			
			For the proof and the algorithm we introduce a decomposition,
			we decompose the motif into
			adjacent element of same step in the stripe 
			(called such sequence segment),
			add the last element to the right most segment,
			and label them form right to left
			with increasing number.
			Let's call this decomposition $S$.
			For each segment, we call important 
			the leftmost element denoted by $IMP$.
			For example, given the motif $(12,11,10,1,2,3,4,9,8,5,6,7)$,
			$S(1)=(5,6,7)$, $IMP(1)=5$, 
			$S(2)=(9,8)$, $IMP(2)=9$, 
			$S(3)=(1,2,3,4)$, $IMP(3)=1$, 
			$S(4)=(12,11,10)$ and $IMP(4)=12$.\\
			
			
			\begin{proof}
			Given a ascent (descent) segment $S(s)$,
			if we want to
			match the suffix $s_ns_{s-1}...s_1$
			starting with an ascent (descent),
			and given that we know every
			match of $s_{s-1}...s_1$,
			the optimal way of matching
			$s_{s-1}...s_1$
			is to choose the match
			that minimize (maximize)
			the maximal (minimal)
			element of the match
			and that allow a match
			of $s_n$.			
			In other word if we want to match 
			$\pmotif[IMP(s):]$
			with $\ptext[i:]$
			and match $IMP(s)$
			with $i$.
			The optimal way
			of matching
			$\pmotif[IMP(s-1):]$
			is to choose the
			minimal (maximal) element $\ptext(i')$
			such that :
			(1) $\pmotif[IMP(s-1):]$ is matched with $\ptext[i':]$
			and $IMP(s-1)$ is matched with $e$.
			(2) The segment $S(s)$ is matched with $\ptext[i:i'-1]$
			and $IMP(s)$ is matched with $i$.
			(3) Every elements of the match of (2),
			is inferior (superior) to the minimal (maximal) element of the match of (1).
			Indeed when we will 
			match $s_{n+1}s_ns_{s-1}...s_1$
			more element will be available,
			because every matched 
			element of $s_{n+1}$
			must be superior (inferior)
			to every matched element
			of $s_{s-1}...s_1$.\\
			  
			
			Consider the following problem :\\
			$LM(s,i)$ = the optimal match of 	
				$IMP(s-1)$ 
				if there exists a match of $\pmotif[IMP(s):]$ 
				with $\ptext[i:]$
				and $IMP(s)$ 
				is matched with element $i$.\\
				
			This problem can be solve by induction.\\
			
			\textbf{BASE :} \\
			$LM(1,i)= \left\{ 
					\begin{array}{l l}
					
						MIN_{i<i'}\{0\} \cup \{i' |\text{ $i'$ such that } & 
						\text{if $\stripe{\pmotif}{IMP(1)}=\ustep$}
						\\
						\text{ $LIS(i,i',\ptext(i')) \leq S(1)$}\}&\\			


						&\\
						
						MAX_{i<i'}\{0\} \cup \{i' |\text{ $i'$ such that } &
						\text{if $\stripe{\pmotif}{IMP(1)}=\dstep$} \\
						\text{ $LDS(i,i',\ptext(i')) \leq S(1)$}\}&\\			

					\end{array} \right. $\\	
		
			\textbf{STEP :} \\
			$LM(s,i)= \left\{ 
					\begin{array}{l l}
					
						MIN \{0\} \cup  I(s,i) & 
						\text{if $\stripe{\pmotif}{IMP(s)}=\ustep$}\\

						
						MAX \{0\} \cup  D(s,i) & 
						\text{if $\stripe{\pmotif}{IMP(s)}=\ustep$}\\
	
						
											
					\end{array} \right. $\\
					
			With $I(s,i)$ ($D(s,i)$) the set of element such that
			if  $e \in I(s,i)$ then there exists 
			a match of $\pmotif[IMP(s-1):]$ in $\ptext[e:]$ and
			there is a match of $s$ in $\ptext[i:e-1]$
			with every element inferior (superior) to the match of  
			$\pmotif[IMP(s-1):]$ in $\ptext[e:]$.
			Formally we define $I(s,i)$ and $D(s,i)$ such as:\\
			
			$I(s,i)=\{i'|\text{$i<i'$ and $LM(s-1,i')\neq 0$}$ \\
			\indent \indent \indent and  $LIS(i,i'-1,IMP(s-1)) \leq S(s) \}$ \\
			
			$D(s,i)=\{i'|\text{$i<i'$ and $LM(s-1,i')\neq 0$}$ \\
			\indent \indent \indent and  $LDS(i,i'-1,IMP(s-1)) \leq S(s) \}$ \\
					                       
			With LIS(i,j,k) (LDS(i,j,k)) is the longest increasing (decreasing) sequence in $\ptext$ starting at $i$ and ending at $j$,
			with every element of this sequence
			inferior (superior) to $k$. 
			LIS and LDS can be computed in $O(|\ptext|^2*log(log(|\ptext|)))$ (see \cite{Bespamyatnikh00enumeratinglongest}).\\
			
			In the base case, 
			we are looking for a match for the first segment.
			Each segment is either ascent or descent.
			If the segment is an ascent (descent)
			we have to find an increasing (decreasing) sequence
			in the text of same size of longest that 
			the size of the segment,
			and to find the optimal solution 
			we must assure that the last element
			of the sequence is minimal (maximal).\\
			For the induction, it is the same idea
			except that we must assure that 
			every element of the sequence is superior 
			to the maximum element of the rest of the match
			or inferior to the minimal element of the rest of the match
			which is given by $LM$ of
			the previous segment.\\
			
			There exists a match of $\pmotif$ in $\ptext$ if and only if
			there exists a $LM(n,i)$ for $1 \leq i \leq |\ptext|$,
			with $n$ the number of segment in $\pmotif$.
			Moreover the basic case can be computed in $O(|\ptext|^2)$
			and the induction on $O(|\pmotif|*|\ptext|^2)$.
			\end{proof}
					
		\section{Pattern Matching With Bivincular Motif Avoiding (231,213)}	
		
			\begin{proposition}
			Let $\bmotif$ be a bivincular motif 
			avoiding (231,213), 
			$\ptext$ a permutation,
			we can decide in $O(|\pmotif|*|\ptext|^3)$ time
			and $O(|\ptext|^3)$ space
			if $\pmotif$ 
			appear in $\ptext$.
			\end{proposition}
					
			\begin{proof}
			We consider the following problem :\\
			
			Given a bivincular motif $\bmotif$ avoiding $(231,213)$,
			a text $\ptext$, $i$,$j$ , $i<j$.\\
			
			$\mathbb{P}_{\bmotif,\ptext,min,max}(i,j)= \left\{ 
				\begin{array}{l l}
					true & \text{If $\pmotif[i:]$ is a motif of $\ptext[j:]$}\\
						& \text{with every element in}\\ 
						&[min,max]\\
		
					false & otherwise\\
				\end{array} \right.$\\
		
		
		
		
			$\mathbb{P}_{\pmotif,\ptext,min,max}$ is closed under induction. 
			it can be
			solved by means of the following relations:\\
			
			
			\textbf{BASE :} \\
			
			if $|\pmotif| \notin  \x : $\\		
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|,j)= \left\{ 
					\begin{array}{l l}
						true & \text{if $min<\ptext(j)<max$
						}\\
						false & otherwise\\
					\end{array} \right. $\\	
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|+1,j)= true $\\
			
			if $|\pmotif| \in  \x : $\\		
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|,|\ptext|)= \left\{ 
					\begin{array}{l l}
						true & \text{if $min<\ptext(|\ptext|)<max$
						}\\
						false & otherwise\\
					\end{array} \right. $\\	
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|+1,|\ptext|)= true $\\
			
			if $|\pmotif| \notin  \x$  
			and $|\pmotif| \in  \y$ 
			and $\pmotif(|\pmotif|)$ is the maximal element: \\		
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|,j)= \left\{ 
					\begin{array}{l l}
						true & \text{if $min<\ptext(j)<max$
						}\\
						&\text{$\ptext(j)$ is the maximal element}\\
						false & otherwise\\
					\end{array} \right. $\\	
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|+1,j)= true $\\
			
			if $|\pmotif| \in  \x$  
			and $|\pmotif| \in  \y$ 
			and $\pmotif(|\pmotif|)$ is the maximal element: \\		
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|,|\ptext|)= \left\{ 
					\begin{array}{l l}
						true & \text{if $min<\ptext(|\ptext|)<max$
						}\\
						&\text{$\ptext(|\ptext|)$ is the maximal element}\\
						false & otherwise\\
					\end{array} \right. $\\	
			$\mathbb{P}_{\bmotif,\ptext,min,max}(|\pmotif|+1,|\ptext|)= true $\\		
								
			\textbf{STEP :} \\		
			$\mathbb{P}_{\bmotif,\ptext,min,max}(i,j)= \\ \left\{ 
					\begin{array}{l l}
					
						\bigcup_{j<k}\mathbb{P}_{\bmotif,\ptext,\ptext(j),max}(i+1,k) 
							& \text{if $\stripe{\pmotif}{i}=\ustep$
							and $i \notin \x$}\\
							& \text{and $i \notin \y$ }\\
							& \text{and $min<\ptext(j)<max$} \\
						&\\
							
						\bigcup_{j<k}\mathbb{P}_{\bmotif,\ptext,min,\ptext(j)}(i+1,k) 
							& \text{if $\stripe{\pmotif}{i}=\dstep$}\\
							& \text{and $i \notin \x$ and $i \notin \y$  }\\
							& \text{and $min<\ptext(j)<max$} \\		
						&\\
							
						\mathbb{P}_{\bmotif,\ptext,t(j),max}(i+1,j+1) 
							& \text{if $\stripe{\pmotif}{i}=\ustep$}\\
							& \text{and $i \in \x$ and $i \notin \y$}\\
							& \text{and $min<\ptext(j)<max$} \\
						&\\
							
						\mathbb{P}_{\bmotif,\ptext,min,t(j)}(i+1,j+1) 
							& \text{if $\stripe{\pmotif}{i}=\dstep$}\\
							& \text{and $i \in \x$ and $i \notin \y$ }\\
							& \text{and $min<\ptext(j)<max$} \\
														
						&\\
													
						\mathbb{P}_{\bmotif,\ptext,\ptext(j),max}(i+1,\ptext^{-1}(\ptext(j)+1)) 
							&\text{if $\stripe{\pmotif}{i}=\ustep$}\\
							&\text{and $i \notin \x$ and $i \in \y$}\\
							& \text{and $min<\ptext(j)<max$} \\
							&\text{and $\ptext^{-1}(\ptext(j)+1)>j$}\\
						&\\
							
						\mathbb{P}_{\bmotif,\ptext,min,\ptext(j)}(i+1,\ptext^{-1}(\ptext(j)-1)) 
							&\text{if $\stripe{\pmotif}{i}=\dstep$}\\
							&\text{and $i \notin \x$ and $i \in \y$ }\\	
							& \text{and $min<\ptext(j)<max$} \\
							&\text{and $\ptext^{-1}(\ptext(j)-1)>j$}\\
						&\\
						
						\mathbb{P}_{\bmotif,\ptext,\ptext(j)),max}(i+1,j+1) 
							&\text{if $\stripe{\pmotif}{i}=\ustep$}\\
							&\text{and $i \in \x$ and $i \in \y$}\\ 
							&\text{and $\ptext(j)+1=\ptext(j+1)$ }\\
							& \text{and $min<\ptext(j)<max$} \\
						&\\
							
						\mathbb{P}_{\bmotif,\ptext,min,\ptext(j)}(i+1,j+1)
							& \text{if $\stripe{\pmotif}{i}=\dstep$}\\
							&\text{and $i \in \x$ and $i \in \y$}\\ 
							&\text{and $\ptext(j)-1=\ptext(j+1)$ }\\
							& \text{and $min<\ptext(j)<max$} \\
						&\\	
						False & Otherwise\\																		
					\end{array} \right. $\\				
				
%			$\mathbb{P}_{\bmotif,\ptext,min,max}(i,j)= \\ \left\{ 
%					\begin{array}{l l}
%						False & \text{if $\ptext(j)<min$ or $max<\ptext(j)$}\\
%						&\\
%					
%						\bigcup_{j<k}\mathbb{P}_{\bmotif,\ptext,t(j),max}(i+1,k) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\ustep$
%							and $i \notin \x$}\\
%							& \text{and $i \notin \y$ }\\
%						&\\
%							
%						\bigcup_{j<k}\mathbb{P}_{\bmotif,\ptext,min,t(j)}(i+1,k) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\dstep$}\\
%							& \text{and $i \notin \x$ and $i \notin \y$  
%							}\\
%						&\\
%							
%						\mathbb{P}_{\bmotif,\ptext,t(j),max}(i+1,j+1) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\ustep$}\\
%							& \text{and $i \in \x$ and $i \notin \y$  
%							}\\
%						&\\
%							
%						\mathbb{P}_{\bmotif,\ptext,min,t(j)}(i+1,j+1) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\dstep$}\\
%							& \text{and $i \in \x$ and $i \notin \y$  
%							}\\							
%						&\\
%							
%						False 
%						& \text{if $\ptext^{-1}(\ptext(j)+1)<j$}\\
%						&\text{and $\mathcal{S}(\pmotif,i)=\ustep$}\\
%						&\text{and $i \in \y$}\\
%						&\\
%							
%						False 
%						& \text{if $\ptext^{-1}(\ptext(j)-1)<j$}\\
%						& \text{and $\mathcal{S}(\pmotif,i)=\dstep$}\\
%						& \text{and $i \in \y$}\\	
%						&\\
%						
%						\mathbb{P}_{\bmotif,\ptext,t(j),max}(i+1,\ptext^{-1}(\ptext(j)+1)) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\ustep$}\\
%							&\text{and $i \notin \x$ and $i \in \y$ 
%							}\\
%						&\\
%							
%						\mathbb{P}_{\bmotif,\ptext,min,t(j)}(i+1,\ptext^{-1}(\ptext(j)-1)) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\dstep$}\\
%							&\text{and $i \notin \x$ and $i \in \y$  
%							}\\	
%						&\\
%						
%						\mathbb{P}_{\bmotif,\ptext,t(j),max}(i+1,j+1) 
%							& \text{if $\mathcal{S}(\pmotif,i)=\ustep$}\\
%							&\text{and $i \in \x$ and $i \in \y$}\\ 
%							&\text{and $\ptext(j)+1=\ptext(j+1)$ 
%							}\\
%						&\\
%							
%						\mathbb{P}_{\bmotif,\ptext,min,t(j)}(i+1,j+1)
%							& \text{if $\mathcal{S}(\pmotif,i)=\dstep$}\\
%							&\text{and $i \in \x$ and $i \in \y$}\\ 
%							&\text{and $\ptext(j)-1=\ptext(j+1)$ 
%							}\\		
%						&\\	
%						False & Otherwise\\																		
%					\end{array} \right. $\\	
						
			At each step (i,j),
			If $i \notin \x$ and $i \notin \y$,
			we match the current element of $\pmotif$ ($\pmotif(i)$)
			with the current element of $\ptext$ ($\ptext(j)$), if possible.
			Then we match $\pmotif[i+1:]$ with 
			every suffixes $\ptext$ starting after $j$.\\
			
			If $i \in \x$ and $i \notin \y$,
			we match $\pmotif(i)$ to $\ptext(j)$, 
			then we match $\pmotif[i+1:]$ with $\ptext[j+1:]$
			with the condition that
			$\pmotif(i+1)$ is matched to $\ptext(j+1)$.\\
			
			If $i \notin \x$, $i \in \y$ and i is a descent,
			we match $\pmotif(i)$ to $\ptext(j)$, 
			then we match $\pmotif[i+1:]$ 
			with $\ptext[\ptext^{-1}(\ptext(j)-1):]$
			with the condition that
			$\pmotif(i+1)$ is matched to the element $\ptext(j)-1$.\\						
			
			If $i \notin \x$, $i \in \y$ and i is an ascent,
			we match $\pmotif(i)$ to $\ptext(j)$, 
			then we match $\pmotif[i+1:]$ 
			with $\ptext[\ptext^{-1}(\ptext(j)+1):]$
			with the condition that
			$\pmotif(i+1)$ is matched to the element $\ptext(j)+1$.\\	

			If $i \in \x$, $i \in \y$ and i is a descent,
			we match $\pmotif(i)$ to $\ptext(j)$, 
			then we match $\pmotif[i+1:]$ with $\ptext[j+1:]$
			with the condition that
			$\pmotif(i+1)$ is matched to $\ptext(j+1)$,
			and that $\ptext(j+1)=\pmotif(i)-1$.\\			

			If $i \in \x$, $i \in \y$ and i is an ascent,
			we match $\pmotif(i)$ to $\ptext(j)$, 
			then we match $\pmotif[i+1:]$ with $\ptext[j+1:]$
			with the condition that
			$\pmotif(i+1)$ is matched to $\ptext(j+1)$,
			and that $\ptext(j+1)=\pmotif(i)+1$.\\		
					
			There are two cases to consider searching for a match : \\
			If $|\pmotif| \in \x$ there exists a match
			if and only if\\ $\bigcup_{0<min<max<|\ptext|}\mathbb{P}_{\pmotif,\ptext,min,max}(0,0)$ is true.\\
			
			If $|\pmotif| \notin \x$ there exists a match if and only if \\	$\bigcup_{0<k<|\ptext|,0<min<max<|\ptext|}\mathbb{P}_{\pmotif,\ptext,min,max}(0,k)$
			is true.			
			\end{proof}
	
	
	\section{Longest Subsequence Avoiding \\(231,213) for a Permutation}

	In this section we present an algorithm to solve the problem
	of the longest subsequence avoiding (231,213).
	To do so, we need the set of element
	that are matched to an ascent and the
	set of element that are matched to a descent.
	For a permutation $\pi$ of size $n$, we define
	$P(\pi) = \{i | \stripe{\pi}{i} = \ustep \} \cup \{n\}$ and  
	$M(\pi) = \{i | \stripe{\pi}{i} = \dstep \} \cup \{n\}$.\\
	
	\begin{proposition}
	\label{proposition:longestIncreasingSubsequence}
	If $s$ is a longest subsequence avoiding (213,231) with last element at index $f$ in $\pi$ then
	$P(\pi)$ is a longest increasing subsequence with last element at index $f$ and
	$M(\pi)$ is a longest decreasing subsequence with last element at index $f$.	
	\end{proposition}
	
	\begin{proof}
	Let's $s$ is a longest subsequence avoiding (213,231) with last element at index $f$ in $\pi$, 
	suppose that $P(\pi)$ is not a longest increasing subsequence with last element at index $f$. Let's $s_m$ be a longest increasing subsequence with last element $f$.
	Thus $|s_m|>P(\pi)$, clearly the sequence $s_m \cup M(\pi)$
	is avoiding (213,231) and is longer than $s$ witch is not possible. 
	The case for $M(\pi)$ follows the same idea.
	\end{proof}

	\begin{proposition}
	Given a permutation $\pi$, 
	finding the longest subsequence avoiding (231,213)
	can be done in $O(|\ptext|*log(log(|\ptext|)))$ time and in $O(n)$ space.	
	\end{proposition}
	
	\begin{proof}
	The proposition \ref{proposition:longestIncreasingSubsequence} lead to algorithm 
	where we have to compute longest increasing and decreasing subsequence ending at every index. Then finding the maximum sum of longest increasing and decreasing subsequence ending at the same index.
	Computing the longest increasing and decreasing can be done in $O(|\ptext|*log(log(|\ptext|)))$ time and $O(n)$ space (see \cite{Bespamyatnikh00enumeratinglongest}), then finding the maximum can be done in linear time.
	\end{proof}


	\section{Longest Subsequence Avoiding \\(231,213) Common for Two Permutation}
	
	In this section we present an algorithm to find 
	the longest common subsequence avoiding (231,213) 
	between two permutations.\\

	\begin{proposition}
	Given two permutation $\pi_1$ and $\pi_2$
	The longest common subsequence
	avoiding (231,213) can be solve in $O(|\pi_1|^3*|\pi_2|^3)$.	
	\end{proposition}
	
	\begin{proof}
	Consider the following problem, 
	that compute the longest stripe common to $\pi_1$ and $\pi_2$.
	Given two permutation $\pi_1$ and $\pi_2$.\\
	
	$S_{\pi_1,\pi_2}(min_1,max_1,min_2,min_2,i_1,i_2)$
	= max$\{$ $|m|$ $|$ 
	s is a pattern occurring 
	in  $\pi_1[i_1:]$
	by the subsequence $s_1$ and $min(s_1)=min_1$ and $max(s_1)=max_1$
	and s is occurring
	in  $\pi_2[i_2:]$
	by the subsequence $s_2$ and $min(s_2)=min_2$ and $max(s_2)=max_2$	
	$\}$\\
	
	We show that this family of problems are closed under induction.\\


	\textbf{BASE :} \\
	$S_{\pi_1,\pi_2,min_1,max_1,min_2,max_2}(|\pi_1|,|\pi_2|) = \left\{ 
			\begin{array}{l l}
				1 & \text{if $min_1<\pi_1(j)<max_1$  
				}\\
				& \text{ and $min_2<\pi_2(j)<max_2$}\\
				0 & otherwise\\
			\end{array} \right. $\\	

	\textbf{STEP :} \\	
	
	$S_{\pi_1,\pi_2,min_1,max_1,min_2,max_2}(i_1,i_2) =$\\
	\indent $ max \left\{ 
			\begin{array}{l l}
				S_{\pi_1,\pi_2,min_1,max_1,min_2,max_2}(i_1,i_2+1) \\
				S_{\pi_1,\pi_2,min_1,max_1,min_2,max_22}(i_1+1,i_2) \\
				S'_{\pi_1,\pi_2,min_1,max_1,min_2,max_2}(i_1,i_2)
			\end{array} \right. $\vspace{20pt}\\	
	
	with 
	$S'_{\pi_1,\pi_2,min_1,max_1,min_2,max_2}(i_1,i_2)=\\ \left\{ 
				\begin{array}{l l}
					1+S_{\pi_1,\pi_2,\pi_1(i_1),max_1,\pi_2(i_2)}(max_2,i_1+1,i_2+1)  & \text{$\pi_1(i_1)<min_1$ } \\
					& \text{and $\pi_2(i_2)<min_2$} \\
					&\\
					1+S_{\pi_1,\pi_2,min_1,\pi_1(i_1),min_2,\pi_2(i_2)}(i_1+1,i_2+1)  & \text{$\pi_1(i_1)>max_1$ } \\	
					&\text{and $\pi_2(i_2)>max_2$}\\	
					&\\	
					0 & \text{otherwise}\\							
				\end{array} \right.$\\
				
	For every pair $i,j$ we either ignore the element of $\pi_1$,
	either ignore the element of $\pi_2$, 
	either we match as the same step (if possible).
	Those relation lead to a $O(|\pi_1|^3*|\pi_2|^3)$ time and $O(|\pi_1|^3*|\pi_2|^3)$ space algorithm.		
	\end{proof}


			
%	\section{Related problems}
%		
%		\textbf{Proposition 3.1} Longest Minimal Common Supersequence, Shortest Maximal Common Subsequence, and Shortest Maximal Common Non-Supersequence are MAX SNP-hard.\\
%		
%		Clearly every problem over (231,213)-Avoiding permutation
%		are equivalent to problem over binary word.
%		The proposition follow what we know about those problem over binary alphabet
%		\cite{Middendorf1995317}.\\
	
	
		
	\section{Conclusion}
		


		  					
\bibliography{bibli}{}
\bibliographystyle{plain}	
			
				      
\end{document}
